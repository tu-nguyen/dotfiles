#!/usr/bin/env bash
# ===================================================================== #
# CHEATSHEET & HELP SYSTEM
# ===================================================================== #

# ------------------------------------------
# General Helper functions or setup
# ------------------------------------------
# Separators
br="${HDR_F}---------------------------------------------------------------------${NC}"

# Generalized function printer
function print_tt() {
    local file="$1"
    if [[ ! -f "$file" ]]; then
        echo -e "File not found: $FILE_C$file$NC"
        return 1
    fi

    # pass KEY_F, S, and NC into awk variables
    awk -v key_f="$EXE_F" -v s="$S" -v h2="$H2" -v nc="$NC" '
    BEGIN { comment="" }

    /^#/ { comment = $0; next }

    /^[a-zA-Z_][a-zA-Z0-9_]* *\(\) *\{/ {
        # Skip internal/hook functions
        if ($0 ~ /^((pre|post)_r) *\(\)/) {
            comment=""
            next
        }

        # Clean up the comment (remove # and leading spaces)
        gsub(/^# *|^## */, "", comment)

        # Extract function name
        match($0, /^[a-zA-Z_][a-zA-Z0-9_]*/)
        func_name = substr($0, RSTART, RLENGTH)

        # Print using the passed variables
        # %-20s ensures the function name column stays aligned
        printf "  %s%-20s%s %s→%s %s\n", key_f, func_name, nc, h2, nc, comment
        comment=""
    }' "$file"
}

# ------------------------------------------
# Main tts
# ------------------------------------------
# General cheatsheet
function tt() {
    if [ -z "$DOTFILES_CONFIG_DIR" ]; then
        DOTFILES_CONFIG_DIR="$HOME/.config/dotfiles"
        printf "${WARN}[ WARN ]${NC} DOTFILES_CONFIG_DIR is not set, defaulting to $DOTFILES_CONFIG_DIR"
    fi

    printf "${HDR_F}tt cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}primary functions${NC}      ${H2}→${NC} ${EXE_F}ttt${NC} (show all tt)            ${H2}→${NC} ${EXE_F}j${NC} (jobs -l)\n"
    printf "                       ${H2}→${NC} ${EXE_F}cls${NC} (clear and ls)           ${H2}→${NC} ${EXE_F}df${NC} (df -H)\n"
    printf "                       ${H2}→${NC} ${EXE_F}mkcd${NC} (mkdir then cd)         ${H2}→${NC} ${EXE_F}du${NC} (du -ch)\n"
    printf "                       ${H2}→${NC} ${EXE_F}h${NC} (history)                  ${H2}→${NC} ${EXE_F}dmesg10${NC} (10 recent logs)\n"
    printf "                       ${H2}→${NC} ${EXE_F}x${NC} (exit)                     ${H2}→${NC} ${EXE_F}top${NC} (htop)\n"
    printf "                       ${H2}→${NC} ${EXE_F}v${NC} (vim)                      ${H2}→${NC} ${EXE_F}top10${NC} (top 10 ps)\n"
    printf "%s\n" "$br"
    printf "${SUB_F}ls & cd${NC}                ${H2}→${NC} ${EXE_F}ll${NC} (ls -alh)                 ${H2}→${NC} ${EXE_F}~${NC} (cd ~)\n"
    printf "                       ${H2}→${NC} ${EXE_F}la${NC} (ls -A)                   ${H2}→${NC} ${EXE_F}..${NC} (cd ..)\n"
    printf "                       ${H2}→${NC} ${EXE_F}lsd${NC} (ls -a1F | grep /$)      ${H2}→${NC} ${EXE_F}...${NC} (cd ../..)\n"
    printf "                       ${H2}→${NC} ${EXE_F}lt${NC} (la -lt)                  ${H2}→${NC} ${EXE_F}....${NC} (cd ../../..)\n"
    printf "                       ${H2}→${NC} ${EXE_F}la${NC} (ls -A)                   ${H2}→${NC} ${EXE_F}.4${NC} (../../../../)\n"
    printf "%s\n" "$br"
    printf "${SUB_F}utils${NC}                  ${H2}→${NC} ${EXE_F}myip${NC} (get ip)                ${H2}→${NC} ${EXE_F}now${NC}/${EXE_F}nowtime${NC} (time)\n"
    printf "                       ${H2}→${NC} ${EXE_F}ping${NC} (ping -c 5)             ${H2}→${NC} ${EXE_F}nowdate${NC} (date)\n"
    printf "                       ${H2}→${NC} ${EXE_F}p4${NC} (ping 4.2.2.2 -c 4)       ${H2}→${NC} ${EXE_F}ipt${NC} (sudo /sbin/iptables)\n"
    printf "                       ${H2}→${NC} ${EXE_F}ports${NC} (netstat -tulanp)      ${H2}→${NC} ${EXE_F}diskspace${NC} (du)\n"
    printf "                       ${H2}→${NC} ${EXE_F}folder${NC} (dir and sizes)       ${H2}→${NC} ${EXE_F}path${NC} (readible \$PATH)\n"
    printf "                       ${H2}→${NC} ${EXE_F}tree${NC} (blazeit)               ${H2}→${NC} ${EXE_F}treed${NC} (tree dir only)\n"
    printf "                       ${H2}→${NC} ${EXE_F}mx${NC} (chmod a+x)               ${H2}→${NC} ${EXE_F}000${NC} (chmod -R 000)\n"
    printf "                       ${H2}→${NC} ${EXE_F}666${NC} (chmod -R 666)           ${H2}→${NC} ${EXE_F}644/755/777${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}other tt${NC}               ${H2}→${NC} ${EXE_F}btt${NC} (bash)                   ${H2}→${NC} ${EXE_F}djtt${NC} (django)\n"
    printf "                       ${H2}→${NC} ${EXE_F}gtt${NC} (git)                    ${H2}→${NC} ${EXE_F}gttt${NC} (git aliases)\n"
    printf "                       ${H2}→${NC} ${EXE_F}sshtt${NC} (ssh)                  ${H2}→${NC} ${EXE_F}makett${NC} (makefile)\n"
    printf "                       ${H2}→${NC} ${EXE_F}pytt${NC} (python)                ${H2}→${NC} ${EXE_F}vtt${NC} (vim)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dctt${NC} (docker-compose)        ${H2}→${NC} ${EXE_F}dktt${NC} (docker)\n"

    if [[ ! -f "$DOTFILES_CONFIG_DIR/.bash_personal" ]]; then
        printf "  ${EXE_F}ptt${NC}                  ${H2}→${NC} config ${FILE_F}.bash_personal${NC} ${RED}does not exist${NC} inside ${DIR_F}$(basename $DOTFILES_CONFIG_DIR)${NC}; run ${EXE_F}set-ptt${NC}\n"
    else
        printf "  ${EXE_F}ptt${NC}                  ${H2}→${NC} to view ${H}personal${NC} stuff\n"
    fi

    if [[ ! -f "$DOTFILES_CONFIG_DIR/.bash_twork" ]]; then
        printf "  ${EXE_F}tworktt${NC}              ${H2}→${NC} config ${FILE_F}.bash_twork${NC} ${RED}does not exist${NC} inside ${DIR_F}$(basename $DOTFILES_CONFIG_DIR)${NC}; run ${EXE_F}set-tworktt${NC}\n"
    else
        printf "  ${EXE_F}tworktt${NC}              ${H2}→${NC} to view ${H}twork${NC} stuff\n"
    fi
    printf "  ${EXE_F}ftt${NC}                  ${H2}→${NC} to view list of ${H}functions${NC}\n"

    printf "%s\n" "$br"
    printf "${SUB_F}reminder${NC}      \n"
    printf "  ${EXE_F}cd-dot${NC}/${EXE_F}dot${NC}           ${H2}→${NC} to acd to original dotfiles dir\n"
}

# Functions cheatsheet
function ftt() {
    printf "${SUB_F}functions${NC}      \n"
    print_tt "$DOTFILES_CONFIG_DIR/.bash_functions"
}

# Bash cheatsheet
function btt() {
    printf "${HDR_F}bash cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}navigation:${NC}\n"
    printf "  ${EXE_F}cd${NC} ${DIM_F}dir${NC}               ${H2}→${NC} Change directory\n"
    printf "  ${EXE_F}cd -${NC}                 ${H2}→${NC} Previous directory\n"
    printf "  ${EXE_F}pwd${NC}                  ${H2}→${NC} Print working directory\n"
    printf "  ${EXE_F}ls -al${NC}               ${H2}→${NC} List files\n"
    printf "%s\n" "$br"
    printf "${SUB_F}file ops:${NC}\n"
    printf "  ${EXE_F}cp${NC} ${DIM_F}src dst${NC}           ${H2}→${NC} Copy file\n"
    printf "  ${EXE_F}mv${NC} ${DIM_F}src dst${NC}           ${H2}→${NC} Move/rename file\n"
    printf "  ${EXE_F}rm${NC} ${DIM_F}file${NC}              ${H2}→${NC} Remove file\n"
    printf "  ${EXE_F}mkdir${NC} ${DIM_F}dir${NC}            ${H2}→${NC} Make directory\n"
    printf "  ${EXE_F}touch${NC} ${DIM_F}file${NC}           ${H2}→${NC} Create empty file\n"
    printf "%s\n" "$br"
    printf "${SUB_F}search:${NC}\n"
    printf "  ${EXE_F}grep${NC} ${DIM_F}PATTERN file${NC}    ${H2}→${NC} Search in file\n"
    printf "  ${EXE_F}tail -f${NC} ${DIM_F}file${NC}         ${H2}→${NC} Follow file changes\n"
    printf "  ${EXE_F}find . -name${NC} ${DIM_F}'*.sh'${NC}  ${H2}→${NC} Find files\n"
    printf "%s\n" "$br"
    printf "${SUB_F}process:${NC}\n"
    printf "  ${EXE_F}ps aux${NC}               ${H2}→${NC} List processes (ps -a | grep firefox)\n"
    printf "  ${EXE_F}top${NC}                  ${H2}→${NC} Interactive process viewer\n"
    printf "  ${EXE_F}kill${NC} ${DIM_F}PID${NC}             ${H2}→${NC} Kill process\n"
    printf "%s\n" "$br"
    printf "${SUB_F}history & jobs:${NC}\n"
    printf "  ${EXE_F}history${NC}              ${H2}→${NC} Show command history\n"
    printf "  ${EXE_F}!!${NC}                   ${H2}→${NC} Repeat last command\n"
    printf "  ${EXE_F}!n${NC}                   ${H2}→${NC} Repeat command n\n"
    printf "  ${EXE_F}jobs${NC}                 ${H2}→${NC} List background jobs\n"
    printf "  ${EXE_F}fg/bg${NC}                ${H2}→${NC} Foreground/background job\n"
    printf "%s\n" "$br"
    printf "${SUB_F}shortcuts:${NC}\n"
    printf "  ${EXE_F}Ctrl+a${NC}               ${H2}→${NC} Start of line\n"
    printf "  ${EXE_F}Ctrl+e${NC}               ${H2}→${NC} End of line\n"
    printf "  ${EXE_F}Ctrl+r${NC}               ${H2}→${NC} Reverse search history\n"
    printf "  ${EXE_F}Ctrl+c${NC}               ${H2}→${NC} Cancel command\n"
    printf "  ${EXE_F}Ctrl+d${NC}               ${H2}→${NC} Logout/EOF\n"
    printf "%s\n" "$br"
    printf "${SUB_F}scripting:${NC}\n"
    printf "  ${EXE_F}echo \"${NC}${ARGS_F}text${NC}${EXE_F}\"${NC}          ${H2}→${NC} Print text\n"
    printf "  ${ARGS_F}VAR${NC}${EXE_F}=${NC}${ARGS_F}value${NC}            ${H2}→${NC} Set variable\n"
    printf "  ${EXE_F}\$${NC}${ARGS_F}VAR${NC}                 ${H2}→${NC} Use variable\n"
    printf "  ${EXE_F}for i in *; do ... done${NC}\n"
    printf "  ${EXE_F}if ...; then ...; fi${NC}\n"
    printf "  ${EXE_F}function${NC} ${ARGS_F}fname${NC}${EXE_F}() { ... }${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}other:${NC}\n"
    printf "  ${EXE_F}ping${NC} ${ARGS_F}8.8.8.8${NC}         ${H2}→${NC} Check connectivity/Network troubleshooting 101\n"
    printf "  ${EXE_F}curl -O${NC} ${ARGS_F}http://example.com/file.txt${NC}\n"
    printf "                       ${H2}→${NC} Grab data/ Downloads without a browser\n"
    printf "%s\n" "$br"
}

# Django cheatsheet
function djtt() {
    printf "${HDR_F}django cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}project:${NC}\n"
    printf "  ${EXE_F}django-admin startproject${NC} ${ARGS_F}myproj${NC}   ${H2}→${NC} New project\n"
    printf "  ${EXE_F}python manage.py startapp${NC} ${ARGS_F}myapp${NC}    ${H2}→${NC} New app\n"
    printf "%s\n" "$br"
    printf "${SUB_F}run & shell:${NC}\n"
    printf "  ${EXE_F}python manage.py runserver${NC}         ${H2}→${NC} Start dev server\n"
    printf "  ${EXE_F}python manage.py shell${NC}             ${H2}→${NC} Django shell\n"
    printf "%s\n" "$br"
    printf "${SUB_F}migrations:${NC}\n"
    printf "  ${EXE_F}python manage.py makemigrations${NC}    ${H2}→${NC} Create migrations\n"
    printf "  ${EXE_F}python manage.py migrate${NC}           ${H2}→${NC} Apply migrations\n"
    printf "%s\n" "$br"
    printf "${SUB_F}superuser & admin:${NC}\n"
    printf "  ${EXE_F}python manage.py createsuperuser${NC}   ${H2}→${NC} Create admin user\n"
    printf "%s\n" "$br"
    printf "${SUB_F}testing:${NC}\n"
    printf "  ${EXE_F}python manage.py test${NC}              ${H2}→${NC} Run tests\n"
    printf "%s\n" "$br"
    printf "${SUB_F}other:${NC}\n"
    printf "  ${EXE_F}python manage.py showmigration${NC}    ${H2}→${NC} List migrations\n"
    printf "  ${EXE_F}python manage.py collectstatic${NC}     ${H2}→${NC} Collect static files\n"
    printf "%s\n" "$br"
}

# Git cheatsheet
function gtt() {
    printf "${HDR_F}git cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}git:${NC}                   ${H2}→${NC} ${EXE_F}ga${NC} (add)                     ${H2}→${NC} ${EXE_F}gb${NC} (branch)\n"
    printf "                       ${H2}→${NC} ${EXE_F}gs${NC} (status)                  ${H2}→${NC} ${EXE_F}gbr${NC} (fance branch)\n"
    printf "                       ${H2}→${NC} ${EXE_F}gc${NC} (cam)                     ${H2}→${NC} ${EXE_F}gbd${NC} (delete branch)\n"
    printf "                       ${H2}→${NC} ${EXE_F}cl${NC} (log)                     ${H2}→${NC} ${EXE_F}gcl${NC} (cl show last commit)\n"
    printf "                       ${H2}→${NC} ${EXE_F}crr${NC} (hard reset)             ${H2}→${NC} ${EXE_F}gll${NC} (bigger log)\n"
    printf "                       ${H2}→${NC} ${EXE_F}gf${NC} (git fetch)               ${H2}→${NC} ${EXE_F}gfetch${NC} (also git fetch)\n"
    printf "${SUB_F}git alt:${NC}               ${H2}→${NC} ${EXE_F}s${NC} (status -s)                ${H2}→${NC} ${KEY_F}b${NC} (fancy branch)\n"
    printf "                       ${H2}→${NC} ${EXE_F}st${NC} (status)                  ${H2}→${NC} ${EXE_F}br${NC} (branch)\n"
    printf "                       ${H2}→${NC} ${EXE_F}co${NC} (checkout)                ${H2}→${NC} ${EXE_F}a${NC} (add)\n"
    printf "                       ${H2}→${NC} ${EXE_F}cob${NC} (checkout -b)            ${H2}→${NC} ${EXE_F}ap${NC} (add -p)\ \n"
    printf "                       ${H2}→${NC} ${EXE_F}coB${NC} (checkout -B)            ${H2}→${NC} ${EXE_F}l${NC} (diff)\n"
    printf "                       ${H2}→${NC} ${EXE_F}c${NC} (commit)                   ${H2}→${NC} ${EXE_F}d${NC} (diff)\n"
    printf "                       ${H2}→${NC} ${EXE_F}ca${NC} (commit -a)               ${H2}→${NC} ${EXE_F}ds${NC} (diff --stat)\n"
    printf "                       ${H2}→${NC} ${EXE_F}cm${NC} (commit -m)               ${H2}→${NC} ${EXE_F}dc${NC} (diff --cached)\n"
    printf "                       ${H2}→${NC} ${EXE_F}cam${NC} (commit -a -m)           \n"
    printf "                       ${H2}→${NC} ${EXE_F}m${NC} (commit -m)                ${H2}→${NC} ${EXE_F}la${NC} (to ALL git config)\n"
    printf "%s\n" "$br"
    printf "${SUB_F}git workflows${NC}\n"
    printf "  ${EXE_F}git revert${NC} ${ARGS_F}commit${NC}                                   ${H2}→${NC} undo commit (creates new commit)\n"
    printf "  ${EXE_F}git reset --soft HEAD~1${NC}                             ${H2}→${NC} undo last commit (keep changes)\n"
    printf "  ${EXE_F}git reset --hard HEAD~1${NC}                             ${H2}→${NC} undo last commit (discard changes)\n"
    printf "  ${EXE_F}git rebase main${NC}                                     ${H2}→${NC} common rebase on feature\n"
    printf "  ${EXE_F}git push --force-with-lease origin${NC} ${ARGS_F}some-feature-branch${NC}   ${H2}(after fixing conflicts from above)${NC}\n"
    printf "  ${EXE_F}git stash save -m "\"${NC}${ARGS_F}message${NC}${EXE_F}\"${NC}"                         ${H2}→${NC} stash with name/message\n"
    printf "  ${EXE_F}agit stash apply stash@{${NC}${ARGS_F}index${NC}${EXE_F}}                      ${H2}→${NC} apply stash\n"
    printf "%s\n" "$br"
    printf "${SUB_F}git functions:${NC}      \n"
    printf "  ${EXE_F}gpull${NC}                ${H2}→${NC} Git pull with rebase and autostash\n"
    printf "  ${EXE_F}gpush${NC}                ${H2}→${NC} Git push with set-upstream\n"
    printf "  ${EXE_F}gco${NC}                  ${H2}→${NC} Switch to a specified Git branch with confirmation\n"
    printf "  ${EXE_F}gcob${NC}                 ${H2}→${NC} Same as above but with fallback to create a branch\n"
    printf "  ${EXE_F}greset${NC}               ${H2}→${NC} Hard reset on current branch\n"
    printf "  ${EXE_F}gclean${NC}               ${H2}→${NC} Hard reset and removes untracked files\n"
    printf "  ${EXE_F}gclone${NC}               ${H2}→${NC} Clone a repo\n"
    printf "  ${EXE_F}grn${NC}                  ${H2}→${NC} Rename git branch\n"
    printf "%s\n" "$br"
    printf "${SUB_F}ghcli run:${NC}\n"
    printf "  ${EXE_F}gh run list${NC}          ${H2}→${NC} List runners (all details)\n"
    printf "  ${EXE_F}gh run cancel${NC} ${ARGS_F}id${NC}     ${H2}→${NC} Cancel a workflow run\n"
    printf "  ${EXE_F}gh run list --json databaseId -q '.[].databaseId' | xargs -d '\\\\n' -n1 gh run cancel${NC}\n"
    printf "                       ${H2}→${NC} Cancels all runners\n"
    printf "  ${EXE_F}gh run delete${NC} ${ARGS_F}id${NC}     ${H2}→${NC} Delete a workflow run\n"
    printf "  ${EXE_F}gh run rerun${NC} ${ARGS_F}id${NC}      ${H2}→${NC} Rerun a workflow run\n"
    printf "  ${EXE_F}gh run view${NC} ${ARGS_F}id${NC}       ${H2}→${NC} View a workflow run\n"
    printf "  ${EXE_F}gh run watch${NC} ${ARGS_F}id${NC}      ${H2}→${NC} Watch a workflow run until it completes\n"
    printf "${SUB_F}gref${NC}${H2}:${NC} git notes\n"
    printf "%s\n" "$br"
    # printf "${SUB_F}todo:${NC}\n"
    # printf "  ${KEY_F}todo${NC}                 ${H2}→${NC} todo\n"
    # printf "  ${KEY_F}todo${NC}                 ${H2}→${NC} todo\n"
    # printf "  ${KEY_F}todo${NC}                 ${H2}→${NC} todo\n"
    printf "%s\n" "$br"
}

# Git cheatsheet ref
function gref() {
    # TODO: reformat header/sub
    printf "${HDR_F}git cheatsheet ref${NC}\n"
    printf "${SUB_F}gref:${NC}\n"
    printf "  ${KEY_F}git${NC}${H2}:${NC} think of git as a db, commit is a record\n"
    printf "    ${H2}:${NC} git is a vcs tool, Github is a cloud-based platform that hosts Github repos\n"
    printf "  ${KEY_F}commit${NC}${H2}:${NC} a snapshot of the entire state, not just changes\n"
    printf "    ${H2}:${NC} a pointer to that complete snapshot\n"
    printf "    ${H2}:${NC} metadata: who created, whem commited, commit message\n"
    printf "    ${H2}:${NC} a pointer to the parent commit directly before it\n"
    printf "  ${KEY_F}DAG${NC}${H2}:${NC} D (directed) A (acyclic) G (graph)\n"
    printf "    ${H2}:${NC} directed: commits point to their parents (backwards in time)\n"
    printf "    ${H2}:${NC} acyclic: You can't go back to the future; no loops!\n"
    printf "  ${KEY_F}branches${NC}${H2}:${NC} are just sticky notes; Just a pointer, that's it!\n"
    printf "    ${H2}:${NC} doesn't contains commit, They point to them.\n"
    printf "    ${H2}:${NC} new commit? The pointer just moves forward\n"
    printf "    ${H2}:${NC} a pointer to that complete snapshot\n"
    printf "    ${H2}:${NC} 'main' isn't special, it's just another sticky note!\n"
    printf "  ${KEY_F}HEAD${NC}${H2}:${NC} how does git know where you are?\n"
    printf "    ${H2}:${NC} is also a pointer but instead of pointing to a commit, it points to a branch\n"
    printf "    ${H2}:${NC} when you are on main >  HEAD -> main -> a1b2c3d\n"
    printf "      ${H2}:${NC} when you run 'git checkout feature\n"
    printf "        ${H2}:${NC} HEAD moves to point at feature branch\n"
    printf "  ${KEY_F}3 stages${NC}${H2}:${NC} working dir -> staging (index) -> repo (.git)\n"
    printf "    ${H2}:${NC} git add: moves changes to the stage (the 'loading dock')\n"
    printf "    ${H2}:${NC} git commit: moves stage to the repo (the 'warehouse')\n"
    printf "    ${H2}:${NC} git checkout/switch: moves repo to working dir\n"
    printf "  ${KEY_F}remotes${NC}${H2}:${NC} 'origin' is just a nickname for a URL\n"
    printf "    ${H2}:${NC} git push: upload your local sticky notes/blobs to the cloud\n"
    printf "    ${H2}:${NC} git fetch: 'what's new?' (downloads data, doesn't touch your code)\n"
    printf "    ${H2}:${NC} git pull: fetch + merge (updates your code immediately)\n"
    printf "%s\n" "$br"
}

# Git cheatsheet expanded
function gttt() {
    printf "${HDR_F}Git Aliases (Active)${NC}\n"
    printf "%s\n" "$br"
    alias | grep 'git' | awk -F"[=']+" -v  key_f="${EXE_F}" -v h2="${H2}" -v nc="${NC}" '
    {
        sub(/alias /, "", $1);
        printf "  %s%-20s%s %s%s%s %s\n", key_f, $1, nc, h2, "→", nc, $2
    }'
    printf "%s\n" "$br"
}

# SSH cheatsheet
function sshtt() {
    printf "${HDR_F}ssh cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}common commands:${NC}\n"
    printf "  ${EXE_F}ssh${NC} ${ARGS_F}user${NC}${KEY_F}@${NC}${ARGS_F}remotehost${NC}                                 ${H2}→${NC} Connect to remote server\n"
    printf "  ${EXE_F}scp${NC} ${ARGS_F}file.txt user${NC}${KEY_F}@${NC}${ARGS_F}remotehost${NC}${KEY_F}:~/${NC}                     ${H2}→${NC} Copy local file to remote server\n"
    printf "  ${EXE_F}scp${NC} ${ARGS_F}user${NC}${KEY_F}@${NC}${ARGS_F}remotehost:${ARGS_F}~/file.txt .${NC}                    ${H2}→${NC} Copy file from a remote server to local\n"
    printf "  ${EXE_F}scp -r${NC} ${ARGS_F}user${NC}${KEY_F}@${NC}${ARGS_F}remotehost${NC}${KEY_F}:${NC}${ARGS_F}/home /home${NC}                  ${H2}→${NC} Recursively copy /home from remote host to local serve\n"
    printf "  ${EXE_F}ssh${NC} ${ARGS_F}user${NC}${KEY_F}@${NC}${ARGS_F}remotehost${NC}${KEY_F} \"cat ${NC}${ARGS_F}/tmp/remotefile${NC}${EXE_F}\" | diff – ${NC}${ARGS_F}/tmp/localfile${NC}\n"
    printf "                                                      ${H2}→${NC} Compare a file on remote server with local host \n"
    printf "%s\n" "$br"
    printf "${SUB_F}other:${NC}\n"
    printf "  ${EXE_F}cat ~/.ssh/id_rsa.pub | ssh${NC} ${ARGS_F}user${NC}${EXE_F}@${NC}${ARGS_F}remotehost${NC} ${EXE_F}\"cat – \>\> ~/.ssh/authorized_keys\"${NC}\n"
    printf "                                                      ${H2}→${NC} Setup passwordless SSH access to another server\n"
    printf "  ${EXE_F}ssh-copy-id -i ~/.ssh/id_rsa.pub${NC} ${ARGS_F}user${NC}${EXE_F}@${NC}${ARGS_F}remotehost${NC}    ${H2}→${NC} Transfer your public key to the remote server \n"
    printf "  ${EXE_F}ssh -D 9999${NC} ${ARGS_F}user${NC}${EXE_F}@${NC}${ARGS_F}remotehost${NC}                         ${H2}→${NC} Tunnel all your browser traffic through your SSH server \n"
    printf "  ${EXE_F}ssh -X${NC} ${ARGS_F}user${NC}${EXE_F}@${NC}${ARGS_F}remote_server${NC} ${EXE_F}\"${NC}${ARGS_F}some_command${NC}${EXE_F}\"${NC}            ${H2}→${NC} Execute one single command  \n"
    printf "%s\n" "$br"
}

# Make cheatsheet
function makett() {
    printf "${HDR_F}makefile cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}common targets:${NC}\n"
    printf "  ${EXE_F}make${NC}                ${H2}→${NC} Run default target\n"
    printf "  ${EXE_F}make${NC} ${ARGS_F}target${NC}         ${H2}→${NC} Run specific target\n"
    printf "%s\n" "$br"
    printf "${SUB_F}variables:${NC}\n"
    printf "  ${ARGS_F}VAR${NC} ${KEY_F}=${NC} ${ARGS_F}value${NC}         ${H2}→${NC} Set variable ${RED}TODO: add entry for ?= and := ${NC}\n"
    printf "  ${ARGS_F}\$(VAR)${NC}              ${H2}→${NC} Use variable\n"
    printf "%s\n" "$br"
    printf "${SUB_F}phony targets:${NC}\n"
    printf "  ${ARGS_F}.PHONY: clean${NC}       ${H2}→${NC} Declare phony target\n"
    printf "%s\n" "$br"
    printf "${SUB_F}examples:${NC}\n"
    printf "  ${ARGS_F}.PHONY: clean\n"
    printf "  clean:\n"
    printf "    rm -rf *.pyc __pycache__/${NC}\n"
    printf "%s\n" "$br"
}

# Python cheatsheet
function pytt() {
    printf "${HDR_F}python cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}run & env:${NC}\n"
    printf "  ${EXE_F}python${NC} ${ARGS_F}file.py${NC}            ${H2}→${NC} Run script\n"
    printf "  ${EXE_F}python -m venv${NC} ${ARGS_F}venv${NC}       ${H2}→${NC} Create virtualenv\n"
    printf "  ${EXE_F}source venv/bin/activate${NC}  ${H2}→${NC} Activate venv\n"
    printf "  ${EXE_F}pip install${NC} ${ARGS_F}package${NC}       ${H2}→${NC} Install package\n"
    printf "  ${EXE_F}pip freeze >${NC} ${ARGS_F}req.txt${NC}      ${H2}→${NC} Export requirements\n"
    printf "  ${EXE_F}pip install -r${NC} ${ARGS_F}req.txt${NC}    ${H2}→${NC} Install from requirements\n"
    printf "%s\n" "$br"
    printf "${SUB_F}common commands:${NC}\n"
    printf "  ${EXE_F}python -m http.server${NC}     ${H2}→${NC} Simple HTTP server\n"
    printf "  ${EXE_F}python -i${NC} ${ARGS_F}file.py${NC}         ${H2}→${NC} Run and enter REPL\n"
    printf "  ${EXE_F}python -c${NC} ${ARGS_F}'code'${NC}          ${H2}→${NC} Run one-liner\n"
    printf "%s\n" "$br"
    printf "${SUB_F}testing:${NC}\n"
    printf "  ${EXE_F}pytest${NC}                    ${H2}→${NC} Run tests\n"
    printf "  ${EXE_F}pytest -k${NC} ${ARGS_F}test_func${NC}       ${H2}→${NC} Run specific test\n"
    printf "  ${EXE_F}coverage run -m pytest${NC}    ${H2}→${NC} Run tests with coverage\n"
    printf "  ${EXE_F}coverage report${NC}           ${H2}→${NC} Show coverage\n"
    printf "%s\n" "$br"
    printf "${SUB_F}formatting & lint:${NC}\n"
    printf "  ${EXE_F}black .${NC}                   ${H2}→${NC} Format code\n"
    printf "  ${EXE_F}isort .${NC}                   ${H2}→${NC} Sort imports\n"
    printf "  ${EXE_F}flake8 .${NC}                  ${H2}→${NC} Lint code\n"
    printf "%s\n" "$br"
}

# Docker-compose cheatsheet
function dctt() {
    printf "${HDR_F}docker-compose cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}common commands:${NC}\n"
    printf "  ${EXE_F}docker-compose up -d${NC}                                ${H2}→${NC} Start services\n"
    printf "  ${EXE_F}docker-compose down${NC}                                 ${H2}→${NC} Stop and remove\n"
    printf "  ${EXE_F}docker-compose build${NC}                                ${H2}→${NC} Build images\n"
    printf "  ${EXE_F}docker-compose logs${NC}                                 ${H2}→${NC} Show logs\n"
    printf "  ${EXE_F}docker-compose exec svc sh${NC}                          ${H2}→${NC} Shell in container\n"
    printf "%s\n" "$br"
    printf "${SUB_F}other:${NC}\n"
    printf "  ${EXE_F}docker-compose ps${NC}                                   ${H2}→${NC} List containers\n"
    printf "  ${EXE_F}docker-compose restart svc${NC}                          ${H2}→${NC} Restart service\n"
    printf "%s\n" "$br"
}

# Docker cheatsheet
function dktt() {
    printf "${HDR_F}docker cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}docker${NC}                 ${H2}→${NC} ${KEY_F}dk${NC} (docker)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dkps${NC} (list running containers)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dkc${NC} (list all docker containers)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dki${NC} (list docker images)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dkdf${NC} (run docker system df)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dkl${NC} (run docker logs <requires at least 1 argument CONTAINER>)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dklf${NC} (docker logs -f <requires at least 1 argument CONTAINER>)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dks${NC} (docker service <require COMMAND ie create, inspect, logs etc>)\n"
    printf "                       ${H2}→${NC} ${EXE_F}dkrm${NC} (docker rm <requires at least 1 argument CONTAINER>)\n"
    printf "%s\n" "$br"
    printf "${SUB_F}docker functions${NC}      \n"
    print_tt "$DOTFILES_CONFIG_DIR/.bash_docker"
    printf "%s\n" "$br"
}

# Vim cheatsheet
function vtt() {
    printf "${HDR_F}vim cheatsheet${NC}\n"
    printf "%s\n" "$br"
    printf "${SUB_F}modes:${NC}\n"
    printf "  ${ARGS_F}i${NC}                    ${H2}→${NC} Insert mode\n"
    printf "  ${ARGS_F}Esc${NC}                  ${H2}→${NC} Normal mode\n"
    printf "  ${ARGS_F}:${NC}                    ${H2}→${NC} Command mode\n"
    printf "%s\n" "$br"
    printf "${SUB_F}navigation:${NC}\n"
    printf "  ${ARGS_F}h j k l${NC}              ${H2}→${NC} Left Down Up Right\n"
    printf "  ${ARGS_F}w/b/e${NC}                ${H2}→${NC} Next/Prev/End of word\n"
    printf "  ${ARGS_F}0/$ ${NC}                 ${H2}→${NC} Start/End of line\n"
    printf "  ${ARGS_F}gg/G${NC}                 ${H2}→${NC} Top/Bottom of file\n"
    printf "%s\n" "$br"
    printf "${SUB_F}editing:${NC}\n"
    printf "  ${ARGS_F}x${NC}                    ${H2}→${NC} Delete char\n"
    printf "  ${ARGS_F}dd${NC}                   ${H2}→${NC} Delete line\n"
    printf "  ${ARGS_F}yy${NC}                   ${H2}→${NC} Yank (copy) line\n"
    printf "  ${ARGS_F}p${NC}                    ${H2}→${NC} Paste\n"
    printf "  ${ARGS_F}u${NC}                    ${H2}→${NC} Undo\n"
    printf "  ${ARGS_F}Ctrl+r${NC}               ${H2}→${NC} Redo\n"
    printf "  ${ARGS_F}r${NC}${WHITE}char${NC}                ${H2}→${NC} Replace char\n"
    printf "%s\n" "$br"
    printf "${SUB_F}search:${NC}\n"
    printf "  ${ARGS_F}/${NC}${WHITE}pattern${NC}             ${H2}→${NC} Search forward\n"
    printf "  ${ARGS_F}?${NC}${WHITE}pattern${NC}             ${H2}→${NC} Search backward\n"
    printf "  ${ARGS_F}n/N${NC}                  ${H2}→${NC} Next/Prev match\n"
    printf "%s\n" "$br"
    printf "${SUB_F}save & quit:${NC}\n"
    printf "  ${ARGS_F}:${NC}${WHITE}w${NC}                   ${H2}→${NC} Save\n"
    printf "  ${ARGS_F}:${NC}${WHITE}q${NC}                   ${H2}→${NC} Quit\n"
    printf "  ${ARGS_F}:${NC}${WHITE}wq${NC}                  ${H2}→${NC} Save & Quit\n"
    printf "  ${ARGS_F}:${NC}${WHITE}q!${NC}                  ${H2}→${NC} Quit without saving\n"
    printf "%s\n" "$br"
}

# General cheatsheet expanded
function ttt() {
    printf "${HDR_F}ttt: Command Reference${NC}\n"
    printf "%s\n" "$br"
    printf "  ${SUB_F}%-20s %-30s %s${NC}\n" "Command" "Description" "Usage Example"
    printf "%s\n" "$br"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "c" "Clear the terminal" "${EXE_F}c${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "cls" "Clear and list files" "${EXE_F}cls${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "clss" "Clear and lsa" "${EXE_F}clss${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "h" "Show command history" "${EXE_F}h${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "x" "Exit the shell" "${EXE_F}x${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "v" "Open vim editor" ${EXE_F}"v${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "j" "List background jobs" "${EXE_F}j${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "df" "Show disk free space" "df -H"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "du" "Show disk usage" "du -ch"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "top" "Interactive process viewer" "top"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "top10" "Show top 10 CPU processes" "top10"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "dmesg10" "Last 10 kernel messages" "dmesg10"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "uptime" "Show system uptime" "uptime -p"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "mkcd" "Make and cd into directory" "mkcd mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "rmd" "Remove directory recursively" "rmd mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "mx" "Make file executable" "mx script.sh"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "000" "chmod 000 recursively" "000 mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "644" "chmod 644 recursively" "644 mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "666" "chmod 666 recursively" "666 mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "755" "chmod 755 recursively" "755 mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "777" "chmod 777 recursively" "777 mydir"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ll" "List all files (long, human)" "ll"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "la" "List all files (almost all)" "la"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "l" "List files" "l"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "lsa" "List all files (long)" "lsa"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "lsd" "List directories only" "lsd"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "lt" "List files sorted by time" "lt"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "l." "List dotfiles" "l."
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "home" "Go to home directory" "home"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "~" "Go to home directory" "~"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" ".." "Go up one directory" ".."
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "..." "Go up two directories" "..."
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "...." "Go up three directories" "...."
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" ".4" "Go up four directories" ".4"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" ".5" "Go up five directories" ".5"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ga" "Git add" "ga file"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gb" "Git branch" "gb"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gbr" "Git fancy branch" "gbr"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gc" "Git commit all message" "gc 'msg'"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gcl" "Git show last commit" "gcl"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gl" "Git log" "gl"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gll" "Git big log" "gll"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "grr" "Git hard reset" "grr"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "gs" "Git status" "gs"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "myip" "Show public IP" "myip"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ping" "Ping 5 times" "ping 8.8.8.8"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "p4" "Ping 4.2.2.2 4 times" "p4"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ports" "Show open ports" "ports"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ipt" "Iptables (sudo)" "ipt"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "iptlist" "List iptables rules" "iptlist"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "iptlistin" "List INPUT rules" "iptlistin"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "iptlistout" "List OUTPUT rules" "iptlistout"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "iptlistfw" "List FORWARD rules" "iptlistfw"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "firewall" "Show firewall rules" "firewall"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "header" "Show HTTP headers" "${EXE_F}header${NC} ${ARGS_F}example.com${NC}"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "headerc" "Show HTTP headers (compressed)" "headerc example.com"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "dnstop" "DNS traffic monitor" "dnstop"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "vnstat" "Network traffic monitor" "vnstat"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "iftop" "Network bandwidth monitor" "iftop"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "tcpdump" "Packet analyzer" "tcpdump"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ethtool" "Ethernet tool" "ethtool"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "iwconfig" "Wireless config" "iwconfig"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "now/nowtime" "Show current time" "nowtime"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "nowdate" "Show current date" "nowdate"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "diskspace" "Show disk usage" "diskspace"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "folder" "Show current folder" "folder"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "path" "Show PATH variable" "path"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "now" "Reload .bashrc" "now"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ebcr" "Edit .bashrc file" "ebcr"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "tree" "Directory tree" "tree"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "treed" "Directory tree (dirs only)" "treed"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "mountedinfo" "Show mounted filesystems" "mountedinfo"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "mktar" "Create tar archive" "mktar files"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "mkbz2" "Create bz2 archive" "mkbz2 files"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "mkgz" "Create gz archive" "mkgz files"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "untar" "Extract tar archive" "untar file.tar"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "unbz2" "Extract bz2 archive" "unbz2 file.tar.bz2"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "ungz" "Extract gz archive" "ungz file.tar.gz"
    printf "  ${EXE_F}%-20s${NC} %-30s %s\n" "so0" "Matrix effect" "so0"
    printf "%s\n" "$br"
}
