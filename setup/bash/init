
# if [[ -f "$HOME/.bash_extras/.init" ]]; then
#     . "$HOME/.bash_extras/.init"
# fi

t() {
  # t "System started"                  # [INFO] System started
  # t WARNING "Disk space low"          # [WARNING] Disk space low
  # t ERROR "Failed to connect to DB"   # [ERROR] Failed to connect to DB
  # t                                   # Hello world
  local severity message color

  if [[ $# -eq 0 ]]; then
    echo -e "${GREEN}Hello world${NC}"
    return
  elif [[ $# -eq 1 ]]; then
    severity="INFO"
    message="$1"
  else
    severity="${1^^}"  # Convert to uppercase
    message="$2"
  fi

  # Determine color and label
  case "$severity" in
    info|INFO)
      echo -e "${BRIGHT_BLUE}[INFO]${NC} $message"
      ;;
    warn|warning|WARNING)
      echo -e "${YELLOW}[WARNING]${NC} $message"
      ;;
    err|error|ERR|ERROR)
      echo -e "${RED}[ERROR] $message ${NC}"
      ;;
    success|ok|SUCCESS|OK)
      echo -e "${GREEN}[SUCCESS] $message ${NC}"
      ;;
    debug|DEBUG)
      echo -e "${CYAN}[DEBUG] $message ${NC}"
      ;;
    *)
      echo -e "${NC}[UNKNOWN] $severity: $message"
      ;;
  esac
}

mkdir -p "$HOME/.bash_extras/init"
ORIGINAL_DOTFILE_CONFIG_FILE="$HOME/.bash_extras/init/.dotfile_config"
if [[ -f "$ORIGINAL_DOTFILE_CONFIG_FILE" ]]; then
    DOTFILE_PATH=$(grep '^DOTFILE_PATH=' "$ORIGINAL_DOTFILE_CONFIG_FILE" | cut -d'=' -f2-)
    if [[ -d "$DOTFILE_PATH" ]]; then
        t INFO "DOTFILE_PATH loaded from $ORIGINAL_DOTFILE_CONFIG_FILE"
    else
        t WARNING "Saved DOTFILE_PATH does not exist in $ORIGINAL_DOTFILE_CONFIG_FILE"
        DOTFILE_PATH=""
    fi
else
  t WARNING "No saved file found at $ORIGINAL_DOTFILE_CONFIG_FILE"
fi

if [[ -z "$DOTFILE_PATH" ]]; then
    CURRENT_PATH="$(pwd)"
    if [[ "$CURRENT_PATH" != "$HOME" ]]; then
        DOTFILE_PATH="$CURRENT_PATH"
    else
        t WARNING "Hardcoding DOTFILE_PATH.."
        DOTFILE_PATH="$HOME/workplace/repo/dotfiles" 
    fi   
else
    t INFO "DOTFILE_PATH is set to: $DOTFILE_PATH"
fi

echo "DOTFILE_PATH=$DOTFILE_PATH" > "$ORIGINAL_DOTFILE_CONFIG_FILE"
export DOTFILE_PATH="$DOTFILE_PATH"
export BASHRC_EXTRAS_PATH="$DOTFILE_PATH/.bash_extras"
export BASHRC_INIT="$BASHRC_EXTRAS_PATH/init"